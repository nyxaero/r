---
title: "Time Series Analysis: Monthly Sunspot Data"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(forecast)
library(tseries)
```

## 1. Dataset Overview

The sunspots dataset contains monthly counts of sunspots observed from 1749 to 1983, spanning 235 years with 2,820 observations. This is one of the longest instrumental time series available. The data exhibits a clear cyclical pattern with a period of approximately 11 years, reflecting solar activity cycles known as the Schwabe cycle.

```{r overview}
data("sunspots")
y <- tail(as.numeric(sunspots), 200)   # last 200 values
ts_y <- ts(y, frequency = 12)
summary(ts_y)
plot(ts_y, main="Sunspots (Last 200 Months)")
```

## 2. Preprocessing

The data is provided as a monthly `ts` object. We verify data quality and check for missing values.

```{r preprocessing}
y[y == 0] <- 0.01
ts_y <- ts(y, frequency = 12)
```

## 3. Stationarity Testing

**Augmented Dickey-Fuller (ADF) Test:**
- **Null Hypothesis (H0):** Series has a unit root (non-stationary)
- **Alternate Hypothesis (H1):** Series is stationary

**KPSS Test:**
- **Null Hypothesis (H0):** Series is level-stationary
- **Alternate Hypothesis (H1):** Series is non-stationary

```{r stationarity}
print(adf.test(ts_y))
print(kpss.test(ts_y))
```

## 4. Differencing and Transformations

We apply seasonal differencing at lag 12 to remove short-term seasonal patterns, then examine the need for further differencing.

```{r transformations}
diff_y <- diff(ts_y)
plot(diff_y, main="Differenced Series")

```

## 5. Model Selection

We compare ARIMA and SARIMA models to select the best fit for this long-cycle solar data.

```{r model_selection}
fit <- hw(ts_y, seasonal="additive", damped=TRUE, h=120)
summary(fit)
```

## 6. Model Diagnostics

Residual diagnostics validate the selected SARIMA model.

```{r diagnostics}
checkresiduals(fit)

lb_test <- Box.test(residuals(fit), 
                    lag = 24, 
                    type = "Ljung-Box", 
                    fitdf = length(fit$coef))

lb_test
```

## 7. Forecasting

We generate 120-month (10-year) forecasts for solar activity.

```{r forecasting}
fc <- forecast(fit, h = 12)
plot(fc, main="12-step forecast â€” Holt-Winters additive damped", ylab="Sunspots")
lines(fitted(fit), col="red", lty=2)
legend("topright", legend=c("Observed","Fitted","Forecast"), col=c("black","red","blue"), lty=c(1,2,1), cex=0.8)
```

## 8. Conclusions

**Key Findings:**
- The sunspot time series exhibits the well-known 11-year Schwabe cycle with variable amplitude and frequency.
- Stationarity tests showed conflicting results due to the long-term cyclical nature; seasonal differencing resolved the issue for modeling.
- SARIMA model outperforms ARIMA (lower AIC), confirming the importance of the seasonal component for capturing solar cycles.
- Residual diagnostics validate model adequacy with acceptable white noise behavior.
- Forecasts show continued cyclical patterns consistent with solar physics understanding.

**Challenges Faced:**
- The long quasi-period (~11 years) and variable cycle amplitude complicate traditional stationarity testing.
- Conflicting ADF/KPSS results required careful model specification with seasonal differencing.
- The 235-year span and cycle periodicity necessitate careful parameter selection in auto.arima.

**Recommendations:**
- The SARIMA model is reliable for 2-3 year forecasts; beyond that, solar physics models should be consulted.
- Forecasts demonstrate that the ~11-year cycle continues, which aligns with astrophysical understanding of solar activity.
- For operational solar forecasting, consider ensemble methods combining statistical and physics-based models.
